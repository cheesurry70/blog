<script>
(function(window) {

window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;

var autotrackOpts = {
  mediaQueryDefinitions: [
    {
      name: 'Breakpoint',
      dimensionIndex: 1,
      items: [
        {name: 'sm', media: 'all'},
        {name: 'md', media: '(min-width: 36em)'},
        {name: 'lg', media: '(min-width: 48em)'}
      ]
    },
    {
      name: 'Resolution',
      dimensionIndex: 2,
      items: [
        {name: '1x',   media: 'all'},
        {name: '1.5x', media: '(-webkit-min-device-pixel-ratio: 1.5), ' +
                              '(min-resolution: 144dpi)'},
        {name: '2x',   media: '(-webkit-min-device-pixel-ratio: 2), ' +
                              '(min-resolution: 192dpi)'},
      ]
    },
    {
      name: 'Orientation',
      dimensionIndex: 3,
      items: [
        {name: 'landscape', media: '(orientation: landscape)'},
        {name: 'portrait',  media: '(orientation: portrait)'}
      ]
    }
  ]
};

ga('create', 'UA-21292978-1', 'auto', {siteSpeedSampleRate: 10});
ga('create', 'UA-21292978-3', 'auto', 'testing', {siteSpeedSampleRate: 10});

{% if site.env != 'production' %}
  ga('set', 'sendHitTask', function(model) {
    console.log('t0', Date.now(), decodeURIComponent(model.get('hitPayload')));
    throw 'Abort tracking in non-production environments.'
  });
  ga('testing.set', 'sendHitTask', function(model) {
    console.log('testing', Date.now(), decodeURIComponent(model.get('hitPayload')));
    throw 'Abort tracking in non-production environments.'
  });
{% endif %}

ga('require', 'mediaQueryTracker', autotrackOpts);
ga('require', 'outboundLinkTracker');
ga('require', 'socialTracker');
ga('require', 'urlChangeTracker');
ga('send', 'pageview');

ga('testing.require', 'mediaQueryTracker', autotrackOpts);
ga('testing.require', 'outboundLinkTracker');
ga('testing.require', 'pageVisibilityTracker');
ga('testing.require', 'socialTracker');
ga('testing.require', 'urlChangeTracker');
ga('testing.send', 'pageview');

}(window));
</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
