<script>
(function(window) {

  // Google Analytics async snippet:
  // http://goo.gl/3FPNDx
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};
  ga.l=+new Date;


  var breakpoints = {
    xs: '(max-width: 419px)',
    sm: '(min-width: 420px) and (max-width: 569px)',
    md: '(min-width: 570px) and (max-width: 799px)',
    lg: '(min-width: 800px) and (max-width: 999px)',
    xl: '(min-width: 1000px)'
  };


  // Create the GA tracker before doing any logging.
  ga('create', 'UA-21292978-1', 'auto', {siteSpeedSampleRate: 100});


  // Uses `navigator.sendBeacon` if available.
  ga('set', 'transport', 'beacon');


  (function trackBreakpoints() {
    // Do nothing in browsers that don't support `window.matchMedia`.
    if (!window.matchMedia) return;

    // Prevent rapid breakpoint changes from all firing at once.
    var timeout;

    Object.keys(breakpoints).forEach(function(breakpoint) {
      var mql = window.matchMedia(breakpoints[breakpoint]);

      // Set the initial breakpoint on pageload.
      if (mql.matches) {
        ga('set', 'dimension1', breakpoint);
      }

      // Update the breakpoint as the matched media changes, and send an event.
      mql.addListener(function(mql) {
        if (mql.matches) {
          clearTimeout(timeout);
          timeout = setTimeout(function() {
            ga('set', 'dimension1', breakpoint);
            ga('send', 'event', 'Breakpoint', 'change', breakpoint);
          }, 1000);
        }
      });
    });
  }());


  {% if site.env != 'production' %}
    // In non-production mode, simply log GA hits to the console.
    // Note, tasks must be set before sending the first hit
    ga(function(tracker) {
      tracker.set('sendHitTask', function() {
        // Throw to stop subsequent tasks.
        throw 'Abort tracking in non-production environments.'
      });
    });
  {% endif %}


  // Sends the initial pageview.
  ga('send', 'pageview');


  // Track uncaught errors via Google Analytics.
  window.onerror = function(message, url, line, col) {
    var desc = message + ' (line: ' + line + ', url: ' + url + ', col: '
        + col + ')';
    ga('send', 'exception', {
      exDescription: 'window.onerror: ' + desc,
      exFatal: false
    });
  };

}(window));
</script>

<script async src="//www.google-analytics.com/analytics.js"></script>
